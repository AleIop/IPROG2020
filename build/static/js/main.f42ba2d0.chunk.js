(this.webpackJsonppeekmusiclab=this.webpackJsonppeekmusiclab||[]).push([[0],{21:function(t,e,n){"use strict";n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return c})),n.d(e,"d",(function(){return o}));var a="https://api.spotify.com/v1/playlists/",r="https://api.spotify.com/v1/audio-features/",c="440325bb5cab47af9d5f1af2cad762fa",o="c5bf0b3bd0ca4d4eac5b684505d7665d"},31:function(t,e,n){},35:function(t,e,n){"use strict";var a=n(36),r=n(37),c=n(0),o=n.n(c),i=n(11),l=n.n(i),u=function(){function t(){Object(a.a)(this,t)}return Object(r.a)(t,null,[{key:"render",value:function(t,e,n){this.cancelCallback&&this.cancelCallback();var a=!1;l.a.render(this.createSpinner(),n),t.then((function(t){a||l.a.render(e(t),n)})).catch((function(t){if(!a){var e=o.a.createElement("span",null,t.message);l.a.render(e,n)}})),this.cancelCallback=function(){a=!0}}},{key:"createSpinner",value:function(){return o.a.createElement("div",{className:"spinnerClass"},o.a.createElement("img",{height:100,alt:"",src:"http://cdn.lowgif.com/full/d9675675623d5f27-loading-gif-transparent-background-loading-gif.gif"}))}}]),t}();e.a=u},40:function(t,e,n){t.exports=n(72)},72:function(t,e,n){"use strict";n.r(e);var a=n(0),r=n.n(a),c=n(11),o=n(18),i=n(12),l=n(38),u=n(14),s=n(13),d=function(t){var e=t.songs,n=t.muted,a=t.homepageControl,c=t.playlistControl,o=t.handleClick,i=Object(s.a)(a,2),l=i[0],u=i[1],d=Object(s.a)(c,2),f=d[0],m=d[1],p=e.length;return r.a.createElement("div",{id:"navbar",className:"navbar debug"},r.a.createElement("button",{onClick:function(){return l()}},u),r.a.createElement("button",{onClick:function(){return f()}},m),r.a.createElement("br",null),r.a.createElement("span",null,"Displaying ",p," of the hottest songs!",r.a.createElement("br",null),"Last update: "),r.a.createElement("div",{className:"muteButton mute",onClick:function(){return o(n.audioMuted)}}))},f=function(t){return{type:"ADD_SONG",song:t}},m=Object(i.b)((function(t,e){return{songs:t.currentPlaylist,muted:t.audioMuted}}),(function(t,e){return{homepageControl:[function(){return e.history.push("/trending")},"Back to the trending songs"],playlistControl:[function(){return e.history.push("/myplaylist")},"My playlist"],handleClick:function(e){t({type:"MUTE_AUDIO",bool:e});var n=document.body.querySelector(".muteButton"),a=n.classList[1];n.classList.remove(a),n.classList.add("mute"==a?"unmute":"mute");var r=document.getElementsByTagName("audio");Object.keys(r).map((function(t){return r[t].muted=e}))}}}))(d),p=(n(31),function(t){var e=t.songs,n=t.whenDone,c=t.onResultsClick,o=t.onAdd,i=t.onLoadPlaylist,l=Object(s.a)(n,2),u=l[0],d=l[1],f=Object(s.a)(o,2);f[0],f[1];return Object(a.useEffect)((function(){i("37i9dQZEVXbMDoHDwVN2tF")}),[]),r.a.createElement("div",{id:"search",className:"mainContent debug"},r.a.createElement("div",{id:"resultsDiv",onClick:function(t){return c(t.target,e)}}),r.a.createElement("button",{className:"nav",onClick:function(){return u()}},d))}),b=n(8),h=Object(i.b)((function(t){return{songs:t.currentPlaylist}}),(function(t,e){return{whenDone:[function(){return e.history.push("/myplaylist")},"Go to My Playlist"],onResultsClick:function(e,n){var a=e.classList.contains("song"),r=e.classList.contains("addButton");if(a){e.id;e.childNodes[1].classList.remove("buttonInvisible"),document.querySelectorAll(".buttonVisible").forEach((function(t){t.classList.remove("buttonVisible"),t.classList.add("buttonInvisible")})),e.firstChild.classList.add("buttonVisible")}if(r){var c=e.parentNode.id,o=n.find((function(t){return t.track.id==c}));Object(b.f)(o),t(f(o))}},onAdd:[function(e){return t(f(e))},"Add to the playlist"],onLoadPlaylist:function(e){Object(b.g)(e).then((function(e){return t({type:"SET_PLAYLIST",songs:e})})),t({type:"LOAD_PLAYLIST",id:e})}}}))(p),g=function(t){var e=t.songs,n=t.getSongCollection,a=t.whenDone,c=(t.onDelete,t.displaySong,Object(s.a)(a,2)),o=c[0],i=c[1];return n().then((function(t){t.map((function(t,e){console.log({song:t});var n=document.createTextNode(t.title),a=document.createElement("tr"),r=document.createElement("td");r.appendChild(n),a.appendChild(r),document.querySelector("tbody").appendChild(a)}))})),r.a.createElement("div",{id:"summary",className:"mainContent debug"},r.a.createElement("div",null,"Current playlist:",r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Song"),r.a.createElement("th",null,"Title"),r.a.createElement("th",null,"Time of addition"))),r.a.createElement("tbody",null),r.a.createElement("tfoot",null,r.a.createElement("tr",null,r.a.createElement("td",null,"TOTAL SONGS"),r.a.createElement("td",null),r.a.createElement("td",null,e.length))))),r.a.createElement("div",null,r.a.createElement("button",{className:"nav",onClick:function(){return o()}},i)))},y=Object(i.b)((function(t){return{songs:t.songs}}),(function(t,e){return{getSongCollection:function(){return Object(b.d)()},whenDone:[function(){return e.history.push("/trending")},"Back to the trending songs"],onDelete:function(t){Object(b.b)(t)},displaySong:function(t){Object(b.e)(t),Object(b.a)(t)}}}))(g),v=function(){return r.a.createElement(l.a,null,r.a.createElement("div",{className:"flexParent"},r.a.createElement(u.d,null,r.a.createElement(u.b,{exact:!0,path:"/",render:function(){return r.a.createElement(u.a,{to:"/trending"})}})),r.a.createElement(u.b,{component:m}),r.a.createElement(u.b,{path:"/trending",component:h}),r.a.createElement(u.b,{path:"/myplaylist",component:y})))},E=n(22);var k=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0,n=e.song;switch(e.type){case"ADD_SONG":var a=t.some((function(t){return t.track.id===n.track.id}));return a?(window.alert("".concat(n.track.name," is already present in the playlist.")),Object(E.a)(t)):[].concat(Object(E.a)(t),[n]);case"REMOVE_SONG":return Object(E.a)(t).filter((function(t){return t.track.id!==n.track.id}));default:return Object(E.a)(t)}},O=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"SET_PLAYLIST":return e.songs;case"LOAD_PLAYLIST":return Object(b.c)(Object(b.g)(e.id)),t;default:return t}},S=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"MUTE_AUDIO":return t.audioMuted=!e.bool,t;default:return t}},j=Object(o.b)({songs:k,currentPlaylist:O,audioMuted:S}),C=localStorage.getItem("reduxState")?JSON.parse(localStorage.getItem("reduxState")):{},w=Object(o.c)(j,C);w.subscribe((function(){return localStorage.setItem("reduxState",JSON.stringify(w.getState()))})),Object(c.render)(r.a.createElement(i.a,{store:w},r.a.createElement(v,null)),document.getElementById("root"))},8:function(t,e,n){"use strict";(function(t){n.d(e,"c",(function(){return f})),n.d(e,"a",(function(){return m})),n.d(e,"g",(function(){return p})),n.d(e,"f",(function(){return h})),n.d(e,"e",(function(){return g})),n.d(e,"b",(function(){return y})),n.d(e,"d",(function(){return v}));var a=n(27),r=n.n(a),c=n(34),o=n(21),i=n(35),l=n(0),u=n.n(l),s=n(54);n(70);s.initializeApp({apiKey:"AIzaSyAPO4fSzO6KUyphdBvNLHr0UMr7ArpPVK4",authDomain:"iprog2020.firebaseapp.com",databaseURL:"https://iprog2020.firebaseio.com",projectId:"iprog2020",storageBucket:"iprog2020.appspot.com",messagingSenderId:"667835768822",appId:"1:667835768822:web:407e0382496fd8a7f731d7"});var d=s.firestore();function f(t){i.a.render(t,(function(t){return u.a.createElement(u.a.Fragment,{},t.map((function(t){return m(t)})))}),document.getElementById("resultsDiv")),setTimeout((function(){document.body.querySelectorAll(".song").forEach((function(t){var e,n=document.getElementById(t.id);(e=t.id,b("?ids="+(e=e||""),"audio").then((function(t){return t.audio_features[0]}))).then((function(t){var e=window.blobCreator(t);n.appendChild(e)}))}))}),1e3)}function m(t){if(null!==t.track.preview_url)return u.a.createElement("div",{id:t.track.id,key:t.track.id,className:"song"},u.a.createElement("audio",{id:"audio"+t.track.id,src:t.track.preview_url,muted:!0}),u.a.createElement("button",{className:"addButton buttonInvisible"},"Add to playlist"),u.a.createElement("br",null),t.track.name,u.a.createElement("br",null))}function p(t){return b(t=t||"37i9dQZEVXbMDoHDwVN2tF","playlist").then((function(t){return t.items}))}function b(e,n){var a=o.b+":"+o.d,i=new t(a).toString("base64"),l="",u=new Headers;u.append("Authorization","Basic "+i);var s=new URLSearchParams;s.append("grant_type","client_credentials");var d=fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:u,body:s,redirect:"follow"}).then((function(t){return t.json()})).catch((function(t){return console.log("error",t)}));function f(){return(f=Object(c.a)(r.a.mark((function t(n){var a,c;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.then((function(t){return l=t.access_token}));case 2:return t.sent,a="playlist"==n?o.c+e+"/tracks":o.a+e,c=fetch(a,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+l}}).then((function(t){return t.json()})),t.abrupt("return",c);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return function(t){return f.apply(this,arguments)}(n)}function h(t){d.collection("playlist").doc(t.track.id).set({id:t.track.id,title:t.track.name,preview:t.track.preview_url,timestamp:s.firestore.FieldValue.serverTimestamp()}).catch((function(t){console.error("Error writing new message to database",t)}))}function g(t){d.collection("playlist").doc(t.track.id).get().then((function(t){console.log("".concat(t.id," => ").concat(t.data().title))}))}function y(t){d.collection("playlist").doc(t).delete().then((function(){console.log("Document successfully deleted!")})).catch((function(t){console.error("Error removing document: ",t)}))}function v(){return d.collection("playlist").get().then((function(t){var e=[];return t.forEach((function(t,n){t.data();console.log("".concat(t.id," => ").concat(t.data())),e.push(t.data())})),console.log({collection:e}),e}))}}).call(this,n(49).Buffer)}},[[40,1,2]]]);
//# sourceMappingURL=main.f42ba2d0.chunk.js.map
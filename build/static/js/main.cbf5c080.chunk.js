(this.webpackJsonppeekmusiclab=this.webpackJsonppeekmusiclab||[]).push([[0],{21:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return l}));var a="https://api.spotify.com/v1/playlists/",r="https://api.spotify.com/v1/audio-features/",o="440325bb5cab47af9d5f1af2cad762fa",l="c5bf0b3bd0ca4d4eac5b684505d7665d"},32:function(e,t,n){},35:function(e,t,n){"use strict";var a=n(36),r=n(37),o=n(0),l=n.n(o),i=n(11),c=n.n(i),s=function(){function e(){Object(a.a)(this,e)}return Object(r.a)(e,null,[{key:"render",value:function(e,t,n){this.cancelCallback&&this.cancelCallback();var a=!1;c.a.render(this.createSpinner(),n),e.then((function(e){a||c.a.render(t(e),n)})).catch((function(e){if(!a){var t=l.a.createElement("span",null,e.message);c.a.render(t,n)}})),this.cancelCallback=function(){a=!0}}},{key:"createSpinner",value:function(){return l.a.createElement("div",{className:"spinnerClass"},l.a.createElement("img",{height:100,alt:"",src:"spinner.svg"}))}}]),e}();t.a=s},4:function(e,t,n){"use strict";(function(e){n.d(t,"c",(function(){return m})),n.d(t,"d",(function(){return p})),n.d(t,"a",(function(){return f})),n.d(t,"h",(function(){return g})),n.d(t,"g",(function(){return v})),n.d(t,"f",(function(){return k})),n.d(t,"b",(function(){return N})),n.d(t,"e",(function(){return O}));var a=n(27),r=n.n(a),o=n(34),l=n(21),i=n(35),c=n(0),s=n.n(c),u=n(54);n(70);u.initializeApp({apiKey:"AIzaSyAPO4fSzO6KUyphdBvNLHr0UMr7ArpPVK4",authDomain:"iprog2020.firebaseapp.com",databaseURL:"https://iprog2020.firebaseio.com",projectId:"iprog2020",storageBucket:"iprog2020.appspot.com",messagingSenderId:"667835768822",appId:"1:667835768822:web:407e0382496fd8a7f731d7"});var d=u.firestore();function m(e){i.a.render(e,(function(e){return s.a.createElement(s.a.Fragment,{},e.map((function(e){return f(e)})))}),document.getElementById("resultsDiv")),setTimeout((function(){document.body.querySelectorAll(".song").forEach((function(e){var t=document.getElementById(e.id);y(e.id).then((function(n){t.childNodes[2].remove(t.childNodes.img);var a=window.blobCreator(n,1);t.appendChild(a);var r=document.getElementById("energyH-"+e.id),o=document.getElementById("keyH-"+e.id),l=document.getElementById("tempoH-"+e.id);null!==r&&(r.innerHTML="Energy: "+n.energy,o.innerHTML="Key: "+n.key,l.innerHTML="Tempo: "+n.tempo+" BPM")}))}))}),1e3)}function p(e,t,n){setTimeout((function(){var n=document.getElementById(e);null===n||n.getElementsByTagName("svg").length||y(e).then((function(e){n.childNodes[2].remove(n.childNodes.img);var a=window.blobCreator(e,t);n.appendChild(a)}))}),1e3)}function f(e){if(null!==e.track.preview_url)return s.a.createElement("div",{id:e.track.id,key:e.track.id,className:"song draggable songtooltip",onDragStart:function(t){return h(t,e)},draggable:!0,onContextMenu:function(t){return b(e.track.id)}},s.a.createElement("audio",{id:"audio"+e.track.id,src:e.track.preview_url,muted:!0,loop:!0}),s.a.createElement("div",{id:"tooltip-"+e.track.id,className:"tooltiptext hidden"},s.a.createElement("h3",null,e.track.name),s.a.createElement("h4",null,e.track.artists.map((function(e){return e.name}))),s.a.createElement("button",null,"Add"),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("button",{className:"secondary-button"},"Remove"),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("a",{href:e.track.external_urls.spotify,target:"_blank",rel:"noopener noreferrer"},"Open in Spotify"),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("h4",{id:"energyH-"+e.track.id}),s.a.createElement("h4",{id:"tempoH-"+e.track.id}),s.a.createElement("h4",{id:"keyH-"+e.track.id})),s.a.createElement("img",{className:"loadingBlobs",src:"blurryblobBW.svg",alt:"blobyfied song",height:"300",width:"300"}),s.a.createElement("br",null))}var h=function(e,t){console.log("Song "+t.track.name+" is being dragged"),e.dataTransfer.setData("text/plain",JSON.stringify(t)),e.dataTransfer.effectAllowed="copy"},b=function(e){console.log("open tooltip");document.getElementsByClassName("tooltiptext visible");var t=document.getElementById("tooltip-"+e),n=t.classList[1];t.classList.remove(n),t.classList.add("hidden"===n?"visible":"hidden")};function g(e){return E(e=e||"37i9dQZEVXbMDoHDwVN2tF","playlist").then((function(e){return e.items}))}function y(e){return E("?ids="+(e=e||""),"audio").then((function(e){return e.audio_features[0]}))}function E(t,n){var a=l.b+":"+l.d,i=new e(a).toString("base64"),c="",s=new Headers;s.append("Authorization","Basic "+i);var u=new URLSearchParams;u.append("grant_type","client_credentials");var d=fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:s,body:u,redirect:"follow"}).then((function(e){return e.json()})).catch((function(e){return console.log("error",e)}));function m(){return(m=Object(o.a)(r.a.mark((function e(n){var a,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.then((function(e){return c=e.access_token}));case 2:return e.sent,a="playlist"===n?l.c+t+"/tracks":l.a+t,o=fetch(a,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+c}}).then((function(e){return e.json()})),e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return function(e){return m.apply(this,arguments)}(n)}function v(e){d.collection("playlist").doc(e.track.id).set({id:e.track.id,title:e.track.name,preview:e.track.preview_url,timestamp:u.firestore.FieldValue.serverTimestamp()}).catch((function(e){console.error("Error writing new message to database",e)}))}function k(e){return console.log("Song in loadSong(): ",{songID:e}),d.collection("playlist").doc(e).get().then((function(e){console.log("in loadSong(): ".concat(e.id," => ").concat(e.data().title))}))}function N(e){d.collection("playlist").doc(e).delete().then((function(){console.log("Document successfully deleted!")})).catch((function(e){console.error("Error removing document: ",e)}))}function O(){return d.collection("playlist").get().then((function(e){var t=[];return e.forEach((function(e,n){return t.push(e.data())})),console.log({collection:t}),t}))}}).call(this,n(49).Buffer)},40:function(e,t,n){e.exports=n(72)},72:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(11),l=n(18),i=n(12),c=n(38),s=n(14),u=n(13),d=function(e){var t=e.songs,n=e.muted,a=(e.nav,e.homepageControl),o=e.playlistControl,l=e.handleClick,i=(e.openNav,e.onDrop),c=e.onDragOver,s=e.selectPlaylist,d=Object(u.a)(a,2),m=(d[0],d[1],Object(u.a)(o,2)),p=m[0],f=m[1],h=(t.length,i),b=c;return r.a.createElement("div",{id:"navbar",className:"navbar debug nothidden"},r.a.createElement("div",{className:"navbarContent"},r.a.createElement("h1",{id:"menu-title"},r.a.createElement("span",{href:"/trending"},"blobify.")),r.a.createElement("div",{className:"navbarContent-playlist"},r.a.createElement("h2",{id:"content-title"},"Pick playlist"),r.a.createElement("h4",{id:"content-title"},"Switch playlist to ",r.a.createElement("span",{className:"tooltip"},"blobify songs ",r.a.createElement("img",{className:"question",src:"info.svg",alt:"info",height:"18",width:"18"}),r.a.createElement("span",{className:"tooltiptext"},"What you see here is not random colors and shapes.",r.a.createElement("br",null),r.a.createElement("br",null),"A blob is a visual representation of a tracks ",r.a.createElement("a",{className:"link",href:"https://developer.spotify.com/documentation/web-api/reference/tracks/get-several-audio-features/",target:"_blank"},"audio features")," - data on its energy, tempo and key.",r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),"The ENERGY of the track is mapped to the number of dots in the blobs which determines its shape.",r.a.createElement("br",null),r.a.createElement("br",null),"The TEMPO of the track is mapped to the speed of the blob.",r.a.createElement("br",null),r.a.createElement("br",null),"The KEY of the track is mapped to the color of the blob based on ",r.a.createElement("a",{className:"link",href:"http://www.harmonics.com/lucy/lsd/colors.html",target:"_blank"},"Charles Fourier's theory."),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),"Click on the blobs for more."))),r.a.createElement("div",{className:"playlist"},r.a.createElement("select",null,r.a.createElement("option",{value:"1",className:"playlistButton selected-playlist",id:"playlist37i9dQZF1DXcBWIGoYBM5M",onClick:function(){return s("37i9dQZF1DXcBWIGoYBM5M")}},"Today's Top Hits"),r.a.createElement("option",{value:"2",className:"playlistButton",id:"playlist37i9dQZEVXbLiRSasKsNU9",onClick:function(){return s("37i9dQZEVXbLiRSasKsNU9")}},"Global Viral 50"),r.a.createElement("option",{value:"3",className:"playlistButton",id:"playlist37i9dQZF1DX4JAvHpjipBk",onClick:function(){return s("37i9dQZF1DX4JAvHpjipBk")}},"New Music Friday"),r.a.createElement("option",{value:"4",className:"playlistButton",id:"playlist37i9dQZF1DX2Wvd8VINtcF",onClick:function(){return s("37i9dQZF1DX2Wvd8VINtcF")}},"Oyster"),r.a.createElement("option",{value:"5",className:"playlistButton",id:"playlist65hCGG0JopRfj06rs1ilmJ",onClick:function(){return s("65hCGG0JopRfj06rs1ilmJ")}},"Musikguiden i P3: B\xe4st just nu"))),r.a.createElement("h5",{id:"fetched"},"Fetched from Spotify")),r.a.createElement("div",{className:"navbarContent-save droppable drophere",onDragOver:b,onDrop:h},r.a.createElement("h2",{id:"content-title"},"Save songs"),r.a.createElement("h4",{id:"content-title"},"Drag and drop blobs here to add songs to your personal collection."),r.a.createElement("div",{className:"collection"},r.a.createElement("div",{id:"miniPreview",className:"miniPreviewScroll"}),r.a.createElement("button",{id:"collection-button",onClick:function(){return p()}},f)))),r.a.createElement("div",{className:"muteButton mute",onClick:function(){return l(n.audioMuted)}}))},m=function(e){return{type:"ADD_SONG",song:e}},p=function(e){return{type:"SET_PLAYLIST",songs:e}},f=function(e){return{type:"LOAD_PLAYLIST",id:e}},h=n(4),b=Object(i.b)((function(e,t){return{songs:e.currentPlaylist,muted:e.audioMuted,nav:e.navbarHidden}}),(function(e,t){return{homepageControl:[function(){return t.history.push("/trending")},"Back to the trending songs"],playlistControl:[function(){for(var e=document.getElementById("miniPreview");e.firstChild;)e.removeChild(e.firstChild);t.history.push("/myplaylist")},"View Collection"],handleClick:function(t){e({type:"MUTE_AUDIO",bool:t});var n=document.body.querySelector(".muteButton"),a=(n.classList[1],document.getElementsByTagName("audio"));!1===t?(console.log("mute"),n.classList.remove("mute"),n.classList.add("unmute")):!0===t&&(console.log("unmute"),n.classList.remove("unmute"),n.classList.add("mute")),Object.keys(a).map((function(e){return a[e].muted=t}))},openNav:function(t){e({type:"HIDE_NAVBAR",bool:t});var n=document.getElementById("navbar"),a=n.classList[2];n.classList.remove(a),n.classList.add("hidden"==a?"nothidden":"hidden")},onDrop:function(t){console.log("Dropped into playlist");var n=t.dataTransfer.getData("text/plain");Object(h.g)(JSON.parse(n));var a=document.getElementById("miniPreview"),r=document.getElementById(JSON.parse(n).track.id),o=document.getElementById(JSON.parse(n).track.id).cloneNode(!0);o.getElementsByTagName("g")[0].setAttribute("transform","matrix(1 0 0 1 0 -10) scale(0.2)"),o.getElementsByTagName("svg")[0].setAttribute("height","50"),o.getElementsByTagName("svg")[0].setAttribute("width","50"),o.addEventListener("click",(function(t){e(function(e){return{type:"REMOVE_SONG",song:e}}(JSON.parse(n)));for(var o=a.children,l=0;l<o.length;l++){var i=o[l];if(i.getAttribute("id")==JSON.parse(n).track.id){a.removeChild(i);break}}r.getElementsByTagName("svg")[0].setAttribute("opacity","1.0")})),o.style.height="70px",o.style.width="60px",a.appendChild(o),r.getElementsByTagName("svg")[0].setAttribute("opacity","0.2")},onDragOver:function(e){e.preventDefault()},selectPlaylist:function(t){document.querySelectorAll(".selected-playlist").forEach((function(e){e.classList.remove("selected-playlist"),e.disabled=!1}));var n=document.body.querySelector("#playlist"+t);n.classList.add("selected-playlist"),n.disabled=!0,Object(h.h)(t).then((function(t){return e(p(t))})),e(f(t))}}}))(d),g=(n(32),function(e){var t=e.songs,n=e.whenDone,o=e.onResultsClick,l=e.onAdd,i=e.onLoadPlaylist,c=Object(u.a)(n,2),s=(c[0],c[1],Object(u.a)(l,2));s[0],s[1];return Object(a.useEffect)((function(){i("37i9dQZEVXbMDoHDwVN2tF")}),[]),r.a.createElement("div",{id:"search",className:"mainContent debug"},r.a.createElement("div",{id:"resultsDiv",onClick:function(e){return o(e.target,t)}}))}),y=Object(i.b)((function(e){return{songs:e.currentPlaylist}}),(function(e,t){return{whenDone:[function(){return t.history.push("/myplaylist")},"Go to My Playlist"],onResultsClick:function(t,n){var a=t.classList.contains("song"),r=t.classList.contains("addButton");if(a){t.id;t.childNodes[1].classList.remove("buttonInvisible"),document.querySelectorAll(".buttonVisible").forEach((function(e){e.classList.remove("buttonVisible"),e.classList.add("buttonInvisible")})),t.firstChild.classList.add("buttonVisible")}if(r){var o=t.parentNode.id,l=n.find((function(e){return e.track.id==o}));Object(h.g)(l),e(m(l))}},onAdd:[function(t){return e(m(t))},"Add to the playlist"],onLoadPlaylist:function(t){Object(h.h)(t).then((function(t){return e(p(t))})),e(f(t))}}}))(g),E=function(e){var t=e.songs,n=e.getSongCollection,a=e.whenDone,o=e.onDelete,l=(e.displaySong,e.getBlob),i=Object(u.a)(a,2),c=i[0];i[1];return n().then((function(e){e.map((function(e,t){console.log("Song in displayPresentational: ",{song:e});var n=document.createElement("tr"),a=document.createElement("td");a.innerHTML=l(e.id,.6),n.appendChild(a);var r=document.createElement("td");n.appendChild(r);var i=document.createTextNode(e.title),c=document.createElement("h4");c.appendChild(i);var s=document.createElement("td");s.appendChild(c),n.appendChild(s);var u=document.createElement("button");u.setAttribute("className","cross delete-song"),u.addEventListener("click",(function(){return o(e)}));var d=document.createElement("td");d.appendChild(u),n.appendChild(d),document.querySelector("tbody").appendChild(n)}))})),r.a.createElement("div",{id:"summary",className:""},r.a.createElement("div",{id:"summaryContent"},r.a.createElement("h2",null,"My blobify collection"),r.a.createElement("div",null,r.a.createElement("div",{className:"cross close-summary",onClick:function(){return c()}})),r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null," "),r.a.createElement("td",null,"TOTAL SONGS ",t.length),r.a.createElement("td",null),r.a.createElement("td",null),r.a.createElement("td",null,r.a.createElement("h4",null,"Delete all")))),r.a.createElement("tbody",{id:"tableBody"}),r.a.createElement("tfoot",null),r.a.createElement("button",{id:"export-button",onClick:function(){return console.log("Export to spotify")}},"Export to Spotify"))),r.a.createElement("div",{id:"backgroundSummary",onClick:function(){return c()}}))},v=Object(i.b)((function(e){return{songs:e.songs}}),(function(e,t){return{getSongCollection:function(){return Object(h.e)()},whenDone:[function(){return t.history.push("/trending")},"Back to the trending songs"],onDelete:function(e){return Object(h.b)(e.id)},displaySong:function(e,t){Object(h.f)(e.id),t.appendChild(Object(h.a)(e))},getBlob:function(e,t){return Object(h.d)(e,t)}}}))(E),k=function(){return r.a.createElement(c.a,null,r.a.createElement("div",{className:"flexParent"},r.a.createElement(s.d,null,r.a.createElement(s.b,{exact:!0,path:"/",render:function(){return r.a.createElement(s.a,{to:"/trending"})}})),r.a.createElement(s.b,{path:"/trending",component:y}),r.a.createElement(s.b,{path:"/myplaylist",component:v}),r.a.createElement(s.b,{component:b})))},N=n(22);var O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=t.song;switch(t.type){case"ADD_SONG":console.log(e);var a=e.some((function(e){return e.track.id===n.track.id}));return a?(window.alert("".concat(n.track.name," is already present in the playlist.")),Object(N.a)(e)):[].concat(Object(N.a)(e),[n]);case"REMOVE_SONG":return Object(N.a)(e).filter((function(e){return e.track.id!==n.track.id}));default:return Object(N.a)(e)}},S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_PLAYLIST":return t.songs;case"LOAD_PLAYLIST":return Object(h.c)(Object(h.h)(t.id)),e;default:return e}},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MUTE_AUDIO":return e.audioMuted=!t.bool,e;default:return e}},B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"HIDE_NAVBAR":return e.navbarHidden=!t.bool,e;default:return e}},w=Object(l.b)({songs:O,currentPlaylist:S,audioMuted:C,navbarHidden:B}),D=localStorage.getItem("reduxState")?JSON.parse(localStorage.getItem("reduxState")):{},L=Object(l.c)(w,D);L.subscribe((function(){return localStorage.setItem("reduxState",JSON.stringify(L.getState()))})),Object(o.render)(r.a.createElement(i.a,{store:L},r.a.createElement(k,null)),document.getElementById("root"))}},[[40,1,2]]]);
//# sourceMappingURL=main.cbf5c080.chunk.js.map